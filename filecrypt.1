.TH FILECRYPT 1 "November 25, 2025" "Version 2.3" "User Commands"
.SH NAME
filecrypt \- file encryption and decryption tool
.SH SYNOPSIS
.B filecrypt
[\fB\-e\fR|\fB\-d\fR]
.B \-i
.I INPUT_FILE
.B \-o
.I OUTPUT_FILE
[\fB\-p\fR \fIPASSWORD\fR | \fB\-k\fR \fIKEYFILE\fR]
[\fB\-a\fR \fIALGORITHM\fR]
[\fB\-t\fR \fITHREADS\fR]
[\fB\-v\fR] [\fB\-P\fR]
.SH DESCRIPTION
.B filecrypt
is a command-line utility for encrypting and decrypting files using OpenSSL cryptographic primitives. It utilizes \fBmmap(2)\fR for memory-mapped I/O to handle large files and \fBpthreads\fR for parallel processing (where supported).

The tool uses PBKDF2-HMAC-SHA256 (100,000 iterations) to derive secure keys from user passwords. It supports multiple encryption algorithms, including AES-256 (CBC and CTR modes), ChaCha20, and a basic XOR cipher.

.SH OPTIONS
.TP
.BR \-e ", " \-\-encrypt
Encrypt mode. This is the default operation if no mode is specified.
.TP
.BR \-d ", " \-\-decrypt
Decrypt mode.
.TP
.BR \-i ", " \-\-input " " \fIFILE\fR
The path to the input file to be processed. (Required)
.TP
.BR \-o ", " \-\-output " " \fIFILE\fR
The path where the resulting file will be written. (Required)
.TP
.BR \-p ", " \-\-password " " \fIPASSWORD\fR
The password used for key derivation. If this flag and \fB\-k\fR are omitted, the program will prompt the user to enter a password securely (without echo).
.TP
.BR \-k ", " \-\-keyfile " " \fIFILE\fR
Path to a file containing a raw 32-byte binary key. If this option is used, password derivation is skipped, and the key is read directly from the file.
.TP
.BR \-a ", " \-\-algorithm " " \fIALG\fR
Select the encryption algorithm. Options... 
.RS
.IP \(bu 2
.B aes256-cbc
(Default) - AES-256 in Cipher Block Chaining mode.
.IP \(bu 2
.B aes256-ctr
- AES-256 in Counter mode.
.IP \(bu 2
.B chacha20
- ChaCha20 stream cipher.
.IP \(bu 2
.B xor
- Basic XOR operation.
.RE
.TP
.BR \-t ", " \-\-threads " " \fINUM\fR
Number of threads to use for parallel processing. Default is 1. Maximum is 8.
.br
\fINote:\fR Multi-threading is automatically disabled for \fBaes256-cbc\fR mode as it requires sequential processing.
.TP
.BR \-v ", " \-\-verbose
Enable verbose output. Displays file sizes, chosen algorithm, and thread count.
.TP
.BR \-P ", " \-\-progress
Display a visual progress bar during processing.
.TP
.BR \-V ", " \-\-version
Print version information and OpenSSL library version, then exit.
.TP
.BR \-h ", " \-\-help
Display help message and exit.

.SH FILE FORMAT
The encrypted file generated by \fBfilecrypt\fR has the following structure:
.PP
.B [Salt (16 bytes)] [IV (16 bytes)] [Original Size (8 bytes)] [Encrypted Data...]
.PP
.IP \(bu 2
\fBSalt\fR: Random 16-byte salt used for PBKDF2 key derivation.
.IP \(bu 2
\fBIV\fR: Initialization Vector (16 bytes) used for the cipher.
.IP \(bu 2
\fBOriginal Size\fR: The size of the unencrypted file, stored as a 64-bit integer.
.PP
This header allows the tool to verify the file integrity and derive the correct decryption key without needing separate metadata files.

.SH EXAMPLES
.B Encrypt a file using default settings (AES-256-CBC):
.RS
filecrypt -i secret.txt -o secret.enc
.RE

.B Decrypt a file:
.RS
filecrypt -d -i secret.enc -o secret.txt
.RE

.B Encrypt a large video using ChaCha20 with 4 threads and a progress bar:
.RS
filecrypt -e -i video.mp4 -o video.enc -a chacha20 -t 4 -P
.RE

.B Encrypt using a pre-generated key file:
.RS
filecrypt -i database.db -o database.enc -k key.bin
.RE

.SH EXIT STATUS
.TP
.B 0
Success.
.TP
.B 1
Generic error (file I/O, memory allocation, or OpenSSL error).
.TP
.B 130
Operation interrupted by user (SIGINT/Ctrl+C).

.SH SIGNALS
.B filecrypt
handles \fBSIGINT\fR (Ctrl+C) and \fBSIGTERM\fR. If interrupted, it attempts to stop processing safely and clean up resources, though the output file may be incomplete.

.SH AUTHOR
Group 1 - Lin Finnegan